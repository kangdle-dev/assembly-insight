<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ì œ22ëŒ€ êµ­íšŒ ë°ì´í„° ì¸ì‚¬ì´íŠ¸ | ëŒ€í•œë¯¼êµ­ êµ­íšŒì˜ì› AI ë¶„ì„ ë¦¬í¬íŠ¸</title>
    <meta name="description" content="ì œ22ëŒ€ êµ­íšŒì˜ì› 296ëª…ì˜ ì •ì±… ë°œí‘œ, SNS í™œë™, ë‰´ìŠ¤ í™”ì œì„±ì„ AIë¡œ ë¶„ì„í•œ ì‹¤ì‹œê°„ ë¦¬í¬íŠ¸ë¥¼ í™•ì¸í•˜ì„¸ìš”.">
    <meta name="keywords" content="êµ­íšŒ, êµ­íšŒì˜ì›, 22ëŒ€êµ­íšŒ, ì˜ì›ì¡°íšŒ, ì •ì±…ë¶„ì„, í™”ì œì„±ìˆœìœ„">
    
    <meta property="og:title" content="êµ­íšŒ ì¸ì‚¬ì´íŠ¸ - ë°ì´í„°ë¡œ ë³´ëŠ” ì˜ì› ë¦¬í¬íŠ¸">
    <meta property="og:description" content="ì˜ì› 296ëª…ì˜ ì‹¤ì‹œê°„ ì´ìŠˆì™€ ì •ì±… ë°ì´í„°ë¥¼ í•œëˆˆì— í™•ì¸í•˜ì„¸ìš”.">
    <meta property="og:image" content="https://assembly-insight.com/og-image.png">    
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32.png">
    <link rel="apple-touch-icon" sizes="192x192" href="/favicon-192.png">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.css');
        :root { --primary: #004EA2; --secondary: #E61E2B; --bg: #f8fafc; }
        body { font-family: 'Pretendard', sans-serif; background: var(--bg); margin: 0; -webkit-tap-highlight-color: transparent; }
        .card { background: white; border-radius: 24px; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.05); border: 1px solid rgba(0,0,0,0.03); }
        .bar { transition: width 1s ease-in-out; }
        .no-scrollbar::-webkit-scrollbar { display: none; }
    </style>
</head>
<body class="pb-24 md:pb-10 text-slate-900">

<div class="max-w-md mx-auto md:max-w-4xl px-4 pt-6">
    <header class="mb-8">
        <h1 class="text-xl font-black mb-6 text-slate-800 flex items-center gap-2">
            <span class="text-blue-600 text-2xl">ğŸŒ</span> 22ëŒ€ êµ­íšŒì˜ì› <span class="text-slate-400 font-light">INSIGHT</span>
        </h1>       

        <div class="mb-6">
            <div class="flex items-center bg-white rounded-2xl shadow-lg px-5 py-4 border-2 border-transparent focus-within:border-blue-500 transition-all">
                <i class="fa-solid fa-magnifying-glass text-slate-400 mr-3"></i>
                <input type="text" id="search-input" placeholder="ì˜ì› ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”" class="w-full outline-none text-base font-semibold">
            </div>
            <div id="search-results" class="absolute w-full top-16 left-0 z-[100] bg-white rounded-2xl shadow-2xl border border-slate-100 hidden max-h-[50vh] overflow-y-auto"></div>
        </div>

        <div class="bg-slate-100 rounded-2xl mb-6 h-20 flex items-center justify-center border border-dashed border-slate-300">
            <span class="text-[10px] font-bold text-slate-400 uppercase tracking-widest italic">AD: Top Billboard (728x90)</span>
        </div>
    </header>

    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-2 gap-4 mb-10">
        <div class="card p-6">
            <h3 class="text-xs font-bold text-slate-400 mb-4 uppercase tracking-widest">ì •ë‹¹ë³„ ì˜ì„ ë¶„í¬</h3>
            <div id="party-charts" class="space-y-4"></div>
        </div>
        <div class="card p-6 text-center flex flex-col justify-center">
            <h3 class="text-xs font-bold text-slate-400 mb-6 uppercase tracking-widest">ë‹¹ì„  í˜•íƒœ</h3>
            <div class="flex justify-around items-center">
                <div><span class="text-3xl font-black text-blue-600" id="stat-local">0</span><p class="text-[10px] text-slate-400 font-bold mt-1 uppercase">ì§€ì—­êµ¬</p></div>
                <div class="w-px h-10 bg-slate-100"></div>
                <div><span class="text-3xl font-black text-purple-500" id="stat-pro">0</span><p class="text-[10px] text-slate-400 font-bold mt-1 uppercase">ë¹„ë¡€ëŒ€í‘œ</p></div>
            </div>
        </div>
    </div>

    <div class="bg-white rounded-3xl p-4 mb-10 border border-slate-200 flex items-center gap-4">
        <div class="w-20 h-20 bg-slate-100 rounded-xl flex-shrink-0 flex items-center justify-center text-[10px] text-slate-400 font-bold italic">AD PIC</div>
        <div class="flex-grow">
            <span class="text-[9px] bg-blue-50 text-blue-600 px-1.5 py-0.5 rounded font-bold uppercase">Sponsor</span>
            <div class="text-sm font-bold text-slate-700 mt-1">ì˜ì • í™œë™ì˜ ìƒˆë¡œìš´ íŒ¨ëŸ¬ë‹¤ì„, êµ­íšŒ ì¸ì‚¬ì´íŠ¸ ê´‘ê³ </div>
            <div class="text-[10px] text-slate-400 mt-0.5">ìì—°ìŠ¤ëŸ½ê²Œ ìŠ¤ë©°ë“œëŠ” ë„¤ì´í‹°ë¸Œ ê´‘ê³ ë¡œ ì „í™˜ìœ¨ ì¦ëŒ€</div>
        </div>
    </div>

    <section class="mb-6">
        <div class="flex items-center justify-between mb-4">
            <h3 class="text-lg font-black text-slate-800">ì˜ì› ëª…ë‹¨</h3>
            <span id="member-count" class="text-[11px] font-bold bg-blue-50 text-blue-600 px-3 py-1 rounded-full tracking-tighter">000ëª…</span>
        </div>
        <div class="flex gap-2 overflow-x-auto no-scrollbar pb-2" id="cho-filter"></div>
    </section>

    <div id="member-grid" class="grid grid-cols-2 md:grid-cols-2 lg:grid-cols-2 gap-3 md:gap-4"></div>

    <div id="infinite-scroll-trigger" class="h-20 flex items-center justify-center mt-4">
        <div id="loading-spinner" class="hidden">
            <i class="fa-solid fa-circle-notch fa-spin text-blue-600 text-2xl"></i>
        </div>
    </div>

    <div class="mt-10 text-center">
        <button id="load-more-btn" class="w-full py-4 rounded-2xl bg-white border border-slate-200 text-slate-600 font-bold text-sm shadow-sm hover:bg-slate-50 transition-all flex items-center justify-center gap-2">
            ì˜ì› ë”ë³´ê¸° <i class="fa-solid fa-chevron-down opacity-50"></i>
        </button>
    </div>
</div>

<nav class="fixed bottom-0 left-0 right-0 bg-white/90 backdrop-blur-md border-t border-slate-100 flex justify-around py-3 z-50 md:hidden">
    <button class="flex flex-col items-center gap-1 text-blue-600"><i class="fa-solid fa-home text-lg"></i><span class="text-[9px] font-bold">í™ˆ</span></button>
    <button class="flex flex-col items-center gap-1 text-slate-400"><i class="fa-solid fa-bolt text-lg"></i><span class="text-[9px]">ì •ì±…ëŒ€ë¦½</span></button>
    <button class="flex flex-col items-center gap-1 text-slate-400"><i class="fa-solid fa-user-shield text-lg"></i><span class="text-[9px]">ë²”ì£„ì´ë ¥</span></button>
</nav>

<script>
    let allMembers = [];
    let filteredMembers = [];
    let displayCount = 12; // í•œ ë²ˆì— ë³´ì—¬ì¤„ ì˜ì› ìˆ˜
    const PAGE_SIZE = 12; // í•œ ë²ˆ ìŠ¤í¬ë¡¤í•  ë•Œë§ˆë‹¤ ì¶”ê°€ë  ê°œìˆ˜
    const CHOSUNG = ['ì „ì²´','ã„±', 'ã„´', 'ã„·', 'ã„¹', 'ã…', 'ã…‚','ã……', 'ã…ˆ', 'ã…Š', 'ã…‹', 'ã…Œ', 'ã…', 'ã…'];

    async function init() {
        try {
            const response = await fetch('data_export/members_all.json');
            if (!response.ok) throw new Error("JSON ë¡œë“œ ì‹¤íŒ¨");
            const rawData = await response.json();
            
            allMembers = rawData.filter(m => m.is_22nd === true || String(m.is_22nd) === "true");
            filteredMembers = allMembers;

            renderChoFilter();
            updateDashboard(allMembers);
            renderGrid();
            initInfiniteScroll(); // ìŠ¤í¬ë¡¤ ê°ì§€ ì‹œì‘
        } catch (error) {
            console.error("Error:", error);
            document.getElementById('member-grid').innerHTML = "<p class='col-span-full text-center py-20 text-slate-400'>ë°ì´í„°ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</p>";
        }
    }

    // í•œê¸€ ì´ˆì„±ì„ ì¶”ì¶œí•˜ëŠ” í—¬í¼ í•¨ìˆ˜
    function getFirstCho(name) {
        const choList = ['ã„±', 'ã„²', 'ã„´', 'ã„·', 'ã„¸', 'ã„¹', 'ã…', 'ã…‚', 'ã…ƒ', 'ã……', 'ã…†', 'ã…‡', 'ã…ˆ', 'ã…‰', 'ã…Š', 'ã…‹', 'ã…Œ', 'ã…', 'ã…'];
        const charCode = name.charCodeAt(0) - 44032;
        if (charCode < 0 || charCode > 11172) return ""; // í•œê¸€ì´ ì•„ë‹Œ ê²½ìš°
        return choList[Math.floor(charCode / 588)];
    }

    // ì´ˆì„± ë²„íŠ¼ ìƒì„± ë¡œì§
    function renderChoFilter() {
        const filterContainer = document.getElementById('cho-filter');
        filterContainer.innerHTML = ''; // ê¸°ì¡´ ë²„íŠ¼ ì´ˆê¸°í™” (ì¤‘ë³µ ë°©ì§€)

        CHOSUNG.forEach(cho => {
            const btn = document.createElement('button');
            // 'ì „ì²´' ë²„íŠ¼ë§Œ ì´ˆê¸° í™œì„±í™” ìƒíƒœë¡œ ì„¤ì •
            const isActive = (cho === 'ì „ì²´');
            btn.className = `cho-btn px-4 py-2 rounded-xl text-xs font-bold shadow-sm border transition-all ${
                isActive ? 'bg-blue-600 text-white border-blue-600' : 'bg-white text-slate-400 border-slate-50'
            }`;
            btn.innerText = cho;
            btn.onclick = () => filterByCho(cho, btn);
            filterContainer.appendChild(btn);
        });
    }

    // ì´ˆì„± í•„í„°ë§ í•¨ìˆ˜
    function filterByCho(targetCho, btn) {
        // ëª¨ë“  ë²„íŠ¼ ë¹„í™œì„±í™” ìŠ¤íƒ€ì¼ ì ìš©
        document.querySelectorAll('.cho-btn').forEach(b => {
            b.classList.remove('bg-blue-600', 'text-white', 'border-blue-600');
            b.classList.add('bg-white', 'text-slate-400', 'border-slate-50');
        });
        // í´ë¦­í•œ ë²„íŠ¼ í™œì„±í™”
        btn.classList.remove('bg-white', 'text-slate-400', 'border-slate-50');
        btn.classList.add('bg-blue-600', 'text-white', 'border-blue-600');

        // í•„í„°ë§ ì‹œ ë°ì´í„° ì´ˆê¸°í™” í•„ìˆ˜
        displayCount = PAGE_SIZE;
        window.scrollTo(0, 0); // ìƒë‹¨ìœ¼ë¡œ ì´ë™
        
        if (targetCho === "ì „ì²´") {
            filteredMembers = allMembers;
        } else {
            filteredMembers = allMembers.filter(m => {
                const charCho = getFirstCho(m.NAAS_NM || m.HG_NM || "");
                const mappedCho = { 'ã„²': 'ã„±', 'ã„¸': 'ã„·', 'ã…ƒ': 'ã…‚', 'ã…†': 'ã……', 'ã…‰': 'ã…ˆ' };
                return (mappedCho[charCho] || charCho) === targetCho;
            });
        }
        renderGrid(false); // ìƒˆë¡œ ë Œë”ë§
    }

    function updateDashboard(data) {
        document.getElementById('member-count').innerText = `${data.length}ëª…`;
        const parties = {};
        let local = 0, pro = 0;
        data.forEach(m => {
            const p = m.CURR_PLPT_NM || "ë¬´ì†Œì†";
            parties[p] = (parties[p] || 0) + 1;
            const dist = m.CURR_ELECD_NM || "";
            if (dist.includes('ë¹„ë¡€')) pro++; else local++;
        });

        const sortedParties = Object.entries(parties).sort((a,b) => b[1] - a[1]);
        document.getElementById('party-charts').innerHTML = sortedParties.slice(0, 4).map(([name, count]) => `
            <div>
                <div class="flex justify-between text-[10px] font-bold mb-1"><span class="text-slate-500">${name}</span><span>${count}</span></div>
                <div class="w-full bg-slate-100 h-1 rounded-full overflow-hidden">
                    <div class="bar h-full rounded-full" style="width: ${(count/data.length*100)}%; background: ${getPartyColor(name)}"></div>
                </div>
            </div>
        `).join('');
        document.getElementById('stat-local').innerText = local;
        document.getElementById('stat-pro').innerText = pro;
    }

    function renderGrid(isAppend = false) {
        const grid = document.getElementById('member-grid');
        const start = isAppend ? displayCount - PAGE_SIZE : 0;
        const itemsToDisplay = filteredMembers.slice(start, displayCount);
        
       // 1. ê²°ê³¼ê°€ ì—†ì„ ê²½ìš° ì²˜ë¦¬
        if (filteredMembers.length === 0) {
            grid.innerHTML = `
                <div class="col-span-full py-20 text-center">
                    <div class="inline-flex items-center justify-center w-16 h-16 bg-slate-100 rounded-full mb-4">
                        <i class="fa-solid fa-user-slash text-slate-300 text-xl"></i>
                    </div>
                    <p class="text-slate-500 font-bold">í•´ë‹¹ ì´ˆì„±ìœ¼ë¡œ ì‹œì‘í•˜ëŠ” ì˜ì›ì´ ì—†ìŠµë‹ˆë‹¤.</p>
                    <p class="text-slate-400 text-xs mt-1">ë‹¤ë¥¸ ì´ˆì„±ì„ ì„ íƒí•˜ê±°ë‚˜ ì „ì²´ ëª…ë‹¨ì„ í™•ì¸í•´ë³´ì„¸ìš”.</p>
                    
                    <div class="mt-8 max-w-sm mx-auto p-4 border border-dashed border-slate-200 rounded-2xl bg-white">
                        <p class="text-[9px] text-slate-300 font-bold mb-2 uppercase">Recommended for you</p>
                        <div class="h-20 bg-slate-50 rounded-xl flex items-center justify-center text-slate-400 text-[11px] italic">
                            ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ì„ ë•Œ ë…¸ì¶œë˜ëŠ” ë§ì¶¤í˜• ê´‘ê³ 
                        </div>
                    </div>
                </div>
            `;
            loadMoreBtn.style.display = 'none'; // ë²„íŠ¼ ìˆ¨ê¹€
            return;
        }

        // 2. ê²°ê³¼ê°€ ìˆì„ ê²½ìš° ë Œë”ë§ (ê¸°ì¡´ ë¡œì§)
        const htmlContent = itemsToDisplay.map((m, idx) => {
            // [ìˆ˜ìµí™” íŒ] íŠ¹ì • ê°„ê²©(ì˜ˆ: 8ë²ˆì§¸ ì¹´ë“œë§ˆë‹¤)ìœ¼ë¡œ ê´‘ê³  ì¹´ë“œ ì‚½ì…
            const adHtml = (isAppend && (start + idx) % 8 === 0) ? `
                <div class="col-span-full my-4 p-4 card bg-slate-50 border-dashed border-slate-200 flex items-center justify-center">
                    <span class="text-[10px] text-slate-300 font-bold uppercase italic">Sponsored Ad</span>
                </div>
            ` : '';

            return `
                ${adHtml}
                <div class="card p-4 flex items-center gap-4 cursor-pointer active:scale-95 transition-all" 
                    onclick="location.href='detail.html?id=${m.NAAS_CD || m.MONA_CD}'">
                    <div class="w-16 h-16 rounded-2xl overflow-hidden bg-slate-100 flex-shrink-0">
                        <img src="./${m.PHOTO_PATH}" class="w-full h-full object-cover" onerror="this.src='https://via.placeholder.com/150x200?text=ğŸ‘¤'">
                    </div>
                    <div>
                        <div class="text-[10px] font-black" style="color: ${getPartyColor(m.CURR_PLPT_NM)}">${m.CURR_PLPT_NM}</div>
                        <div class="font-bold text-slate-800">${m.NAAS_NM || m.HG_NM}</div>
                        <div class="text-[9px] text-slate-400 font-bold">${m.CURR_ELECD_NM}</div>
                    </div>
                </div>
            `;
        }).join('');

        if (isAppend) {
            grid.insertAdjacentHTML('beforeend', htmlContent);
        } else {
            grid.innerHTML = htmlContent;
        }

        // ë”ë³´ê¸° ë²„íŠ¼ ë…¸ì¶œ ì—¬ë¶€
        // document.getElementById('load-more-btn').style.display = (displayCount >= filteredMembers.length) ? 'none' : 'flex';
    }

    // ë¬´í•œ ìŠ¤í¬ë¡¤ ì˜µì €ë²„ ì„¤ì •
    function initInfiniteScroll() {
        const trigger = document.getElementById('infinite-scroll-trigger');
        const spinner = document.getElementById('loading-spinner');

        const observer = new IntersectionObserver((entries) => {
            if (entries[0].isIntersecting && displayCount < filteredMembers.length) {
                spinner.classList.remove('hidden'); // ë¡œë”© í‘œì‹œ
                
                // ì•½ê°„ì˜ ì§€ì—°(0.5ì´ˆ)ì„ ì£¼ì–´ ìì—°ìŠ¤ëŸ¬ìš´ ë¡œë”© ì—°ì¶œ
                setTimeout(() => {
                    displayCount += PAGE_SIZE;
                    renderGrid(true);
                    spinner.classList.add('hidden');
                }, 500);
            }
        }, { threshold: 0.1 });

        observer.observe(trigger);
    }

    // ë”ë³´ê¸° ë²„íŠ¼ ì´ë²¤íŠ¸
    document.getElementById('load-more-btn').onclick = () => {
        displayCount += 12;
        renderGrid();
    };

    function getPartyColor(party) {
        if (!party) return '#cbd5e1';
        if (party.includes('ë”ë¶ˆì–´ë¯¼ì£¼ë‹¹')) return '#004EA2';
        if (party.includes('êµ­ë¯¼ì˜í˜')) return '#E61E2B';
        if (party.includes('ì¡°êµ­í˜ì‹ ë‹¹')) return '#00A0E2';
        if (party.includes('ê°œí˜ì‹ ë‹¹')) return '#FF6600';
        return '#64748b';
    }

    init();
</script>
</body>
</html>